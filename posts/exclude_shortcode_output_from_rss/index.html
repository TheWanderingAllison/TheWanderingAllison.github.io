<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en-zh"><head itemscope itemtype="https://thewanderingallison.github.io/">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noarchive"> 
  
  <meta property="og:locale" content="en">
  <meta name="language" content="en">

  
  

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EDY88XRQS6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-EDY88XRQS6');
  </script>


  
  <meta property="og:locale" content="en">
  <meta name="language" content="en">
  
  <title itemprop="name">如何从 Hugo 的 RSS 输出中排除短代码 &middot; The Wandering Allison</title>
  <meta property="og:title" content="如何从 Hugo 的 RSS 输出中排除短代码 &middot; The Wandering Allison" />
  <meta itemprop="name" content="如何从 Hugo 的 RSS 输出中排除短代码 &middot; The Wandering Allison" />
  <meta name="application-name" content="The Wandering Allison" />
  <meta property="og:site_name" content="The Wandering Allison" />
  
  <base href="https://thewanderingallison.github.io/posts/exclude_shortcode_output_from_rss/">
  <link rel="canonical" href="https://thewanderingallison.github.io/posts/exclude_shortcode_output_from_rss/" itemprop="url" />
  <meta name="url" content="https://thewanderingallison.github.io/posts/exclude_shortcode_output_from_rss/" />
  <meta property="og:url" content="https://thewanderingallison.github.io/posts/exclude_shortcode_output_from_rss/" />
  
  
  
  <meta itemprop="image" content="https://thewanderingallison.github.io/images/og_image.jpg" />
  <meta property="og:image" content="https://thewanderingallison.github.io/images/og_image.jpg" />
  
  
  
  
  <meta property="og:type" content="article" />
  <meta itemprop="description" content="我和很多人一样，在博文中使用了豆瓣/NeoDB 卡片短代码，效果如下： .db-card { margin: 2.5rem 3rem; background: var(--card-background); border-radius: 7px; box-shadow: 0 6px 10px #00000053 } ." />
  <meta property="og:description" content="我和很多人一样，在博文中使用了豆瓣/NeoDB 卡片短代码，效果如下： .db-card { margin: 2.5rem 3rem; background: var(--card-background); border-radius: 7px; box-shadow: 0 6px 10px #00000053 } ." />
  <meta name="description" content="我和很多人一样，在博文中使用了豆瓣/NeoDB 卡片短代码，效果如下： .db-card { margin: 2.5rem 3rem; background: var(--card-background); border-radius: 7px; box-shadow: 0 6px 10px #00000053 } ." />
  <meta property="article:published_time" content=" 2024-12-07T00:00:00Z" />
  
  <meta property="article:tag" content="Toolbox" />
  
  <meta property="article:tag" content="Hugo" />
  
  <meta property="article:tag" content="RSS" />
  
  <meta property="article:tag" content="Blog" />
  
  

  <meta property="og:updated_time" content=2024-12-07T00:00:00Z />

  

  

  <meta name="generator" content="Hugo 0.81.0" />

  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

  
  
  <link rel="stylesheet" href="/css/styles.css">

  
  
  <link href="/%20index.xml" rel="alternate" type="application/rss+xml" title="The Wandering Allison" />
  
  
  

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js"></script>
  
</head><body class="bg-gradient flex flex-col min-h-screen"><head>
  
  
</head>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-EDY88XRQS6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EDY88XRQS6');
</script>


<script defer src="https://cloud.umami.is/script.js" data-website-id="70a90f30-1085-438a-ae97-8e16ca69ed1b"></script>


<script defer src="https://umamitest-allisons-projects-ff0e6fda.vercel.app/script.js" data-website-id="bddb577f-d261-443f-904a-cce83793830c"></script>


  <header id="header" class="w-full m-0 fixed z-10 transition-all duration-300 ease-in-out border-t-4 border-gray-300 py-4 backdrop-filter-blur">
    <div id="header-container" class="max-w-7xl mx-auto p-6 flex items-center flex-wrap lg:flex-no-wrap relative justify-between">
      <a href="https://thewanderingallison.github.io/" class="leading-10 text-3xl font-normal text-gray-600 flex flex-shrink-0 article_title
      ">
        The Wandering Allison
      </a>

      <div class="block lg:hidden mx-2">
        <button class="nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out">
  <svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <title>Menu</title>
    <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
  </svg>
</button>
<button class="hidden nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out">
  <svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <title>Close menu</title>
    <polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)" />
  </svg>
</button>

      </div>

      <div class="absolute right-8 top-16 lg:relative lg:right-0 lg:top-0 flex flex-col lg:flex-row items-center rounded-md bg-white shadow lg:bg-transparent lg:shadow-none">

        <nav id="nav-menu" class="p-4 lg:p-0 hidden lg:block w-full lg:w-auto text-gray-600">
          <ul class="w-full flex flex-col lg:flex-row justify-end items-end lg:items-center">
  
    <li class="flex my-2 lg:my-2 mx-1 lg:mx-2">
      <a title="About" class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out article_title" href="/about">About</a>
    </li>
  
    <li class="flex my-2 lg:my-2 mx-1 lg:mx-2">
      <a title="Archives" class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out article_title" href="/archives">Archives</a>
    </li>
  
    <li class="flex my-2 lg:my-2 mx-1 lg:mx-2">
      <a title="Friends" class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out article_title" href="/friends">Friends</a>
    </li>
  
</ul>

        </nav>
      </div>
    </div>
  </header>

<main class="flex-1 mt-12 max-w-3xl mt-32 mx-auto text-gray-700 w-full">
<div id="reading-progress-bar" role="presentation" class="fixed z-10 top-0 left-0 h-1 bg-gray-700"></div>

<article class="article">
    <h1 class="article_title"><a href="https://thewanderingallison.github.io/posts/exclude_shortcode_output_from_rss/" class="article_title">如何从 Hugo 的 RSS 输出中排除短代码</a></h1>

    
<ul id="categories">
  
    <li><a href="https://thewanderingallison.github.io/categories/toolbox">Toolbox</a> </li>
  
</ul>


    
      <header class="article__header">
          <time datetime="2024-12-07T00:00:00&#43;00:00">
            7 Dec, 2024
          </time>
        </span>
      </header>
    

    <div class="py-5">
      <p>我和很多人一样，在博文中使用了豆瓣/NeoDB 卡片短代码，效果如下：</p>
<style>
     
    .db-card {
        margin: 2.5rem 3rem;
        background: var(--card-background);
        border-radius: 7px;
        box-shadow: 0 6px 10px #00000053
    }

    .db-card-subject {
        display: flex;
        align-items: flex-start;
        line-height: 1.6;
        padding: 12px;
        position: relative
    }

    .dark .db-card {
        background: var(--card-background)
    }

    .db-card-content {
        flex: auto
    }

    .db-card-post {
        width: 100px;
        margin-right: 15px;
        display: flex;
        flex: none
    }

    .db-card-title {
        margin-bottom: 3px;
        font-size: 16px;
        color: var(--card-text-color-main)
    }

    .db-card-title a {
        text-decoration: none !important
    }

    .db-card-abstract,
    .db-card-comment {
        font-size: 13px;
        overflow: auto;
        max-height: 10rem;
        color: var(--card-text-color-main)
    }

    .db-card-cate {
        position: absolute;
        top: 0;
        right: 0;
        background: #ffd7e4;
        padding: 1px 8px;
        font-size: small;
        font-style: italic;
        border-radius: 0 8px 0 8px;
        text-transform: capitalize
    }

    .db-card-post img {
        width: 100px !important;
        height: 150px !important;
        border-radius: 4px;
        -o-object-fit: cover;
        object-fit: cover
    }

    @media(max-width: 550px) {
        .db-card {
            margin: .8rem 1rem
        }

        .db-card-comment {
            display: none
        }
    }

     
</style>


































































































































































































































































<div class="db-card">
    <div class="db-card-subject">
        <div class="db-card-post"><img loading="lazy" decoding="async" referrerpolicy="no-referrer" src="https://img3.doubanio.com/view/subject/m/public/s33611037.jpg">
        </div>
        <div class="db-card-content">
            <div class="db-card-title"><a href="https://book.douban.com/subject/34852406/" class="cute" target="_blank" rel="noreferrer">PLUS / SLAM DUNK ILLUSTRATIONS 2</a></div>
            <div class="db-card-abstract">「週刊少年ジャンプ」で連載されるや読者から圧倒的な支持を受け、同誌が前人未到の最大発行部数653万部を達成した1995年新年3・4合併号では全ページフルカラーで巻頭を飾った、ジャンプを代表する国民的漫画『SLAM DUNK』(スラムダンク)。
その『SLAM DUNK』のイラスト130点超をまとめたイラスト集『PLUS/ SLAM DUNK ILLUSTRATIONS 2 』 (プラス/ スラムダンク イラストレーションズ 2)が2020年4月3日に発売決定。『SLAM DUNK』のイラスト集としては、1997年6月に刊行され、今なお版を重ねている『INOUE TAKEHIKO ILLUSTRATIONS』に続く、第2弾となります。
本イラスト集では、2018年に装いを新たに刊行した『SLAM DUNK』新装再編版(全20巻)のカバーイラストを中心に、『SLAM DUNK』完全版(全24巻/2001~2002年)や『SLAM DUNK』1億冊感謝記念新聞広告(2004年)など様々な出版物・企画・商品のために描かれたイラスト130点超を収録予定。もちろん全イラスト初収録。この中には、スケッチや習作段階の未公開イラストも複数含まれ、さらにカバーイラストを含めた11点を井上雄彦氏が新たに描き下ろします。
約30cm四方の大型特殊判型本のページをめくるたびに現れる、鮮烈かつ美麗なイラストからは個性豊かなキャラクターたちの“息吹&#34;が感じられます。
また、初版限定特典として、カバーイラストをタテ12cm×ヨコ24cmサイズに印刷した特製ポストカードが封入されます。</div>
        </div>
    </div>
</div>









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<p>在 RSS 阅读器中这个卡片会失去样式变成混乱的内容堆叠，因此想在 RSS 输出中排除掉短代码。不过这也是因为我是全文输出，RSS 只输出摘要的不会有此烦恼。</p>
<p>本来我想改 Hugo 的 <code>rss.xml</code> 文件，在 <code>&lt;description&gt;</code> 部分添加筛选条件去除包含短代码的内容，但不知为何总是不成功，让 ChatGPT 改了好多遍还是失败。</p>
<p>没想到最后直接 Google 关键词在 Hugo 的讨论区找到答案了，


<a href="https://discourse.gohugo.io/t/exclude-shortcode-output-from-rss/51008" target="_blank" rel="noreferrer noopener">Exclude shortcode output from RSS?</a>
。</p>
<p>简单来说就是在 <code>layouts/shortcodes</code> 下直接创建一个同名文件，比如我的豆瓣卡片是 <code>douban.html</code>，那就新建一个 <code>douban.xml</code>，内容为空就是在 RSS 中彻底移除短代码，也可以在这个文件里加上特定内容取代原本短代码的输出（我图省事只创建了空白文件）。</p>
<p>原本我想在 <code>rss.xml</code> 中的 <code>&lt;description&gt;</code> 部分加上一个 if 语句通过判断是否有内容被移除，以此来确定是否在 RSS 文章内容顶端添加提醒，比如“某些样式在 RSS 中无法显示，请点击原文查看”。但是现在的 shortcode 替换并不发生在 <code>rss.xml</code> 中，就无法如此操作。考虑了下我把 <code>&lt;description&gt;</code> 改成了下面这样，不进行判断，只要在 RSS 阅读器阅读都会看到提醒。（但我之前在 Inoreader 试了下怎么好像也看不到这行字？不知哪里出了问题，下次再解决吧……）</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;description&gt;</span>
    <span style="color:#000080">&lt;p&gt;</span>The specific style in some posts may have been removed in RSS feed. <span style="color:#000080">&lt;a</span> <span style="color:#008080">href=</span><span style="color:#d14">&#34;{{ .Permalink }}&#34;</span><span style="color:#000080">&gt;</span>Click here<span style="color:#000080">&lt;/a&gt;</span> to view the original post.<span style="color:#000080">&lt;/p&gt;</span>
    {{ .Content | html }}
<span style="color:#000080">&lt;/description&gt;</span>
</code></pre></div>
    </div>
    
    <ul id="tags">
        <li> <a href="https://thewanderingallison.github.io/tags/toolbox">Toolbox</a> </li>
        <li> <a href="https://thewanderingallison.github.io/tags/hugo">Hugo</a> </li>
        <li> <a href="https://thewanderingallison.github.io/tags/rss">RSS</a> </li>
        <li> <a href="https://thewanderingallison.github.io/tags/blog">Blog</a> </li>
      
    </ul>
    


  <aside class="flex">
  
    <a class="w-full md:w-1/2 flex flex-col items-center py-7 px-3 no-underline rounded-md hover:bg-white transition duration-300 ease-in-out article_title" href="/posts/cooking_collection-of-everyday-food-recipes/">
      <span class="border border-gray-6 text-xs rounded-md mb-2 uppercase font-bold py-2 px-3">Read this next</span>
      <span class="text-center">一人食友好的家常菜谱合集</span>
    </a>
  
  
    <a class="w-full md:w-1/2 flex flex-col items-center py-7 px-3 no-underline rounded-md hover:bg-white transition duration-300 ease-in-out article_title" href="/posts/anniversary_should-i-continue/">
      <span class="border border-gray-6 text-xs rounded-md mb-2 uppercase font-bold py-2 px-3">You might enjoy</span>
      <span class="text-center">四周年|随便聊聊</span>
    </a>
  
</aside>




  <section class="comments ">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
<script>
    

    

    (function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://the-wandering-allison.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  </section>

</article>


  </main>
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  
      
  

   
   
   
   


<footer class="w-full max-w-7xl mx-auto text-center border-t border-gray-200 py-9 px-3 mt-9 pin-b text-sm text-gray-500">

  Made with <a href="https://gohugo.io" class="underline transition duration-300 ease-in-out hover:text-blue-600">Hugo</a> and <a href="https://github.com/leonardofaria/bento" class="underline transition duration-300 ease-in-out hover:text-blue-600">Bento theme</a>.
  <div>
   <p>Copyright © 2020-2025 Allison</p>
  </div>  
  <div>
    <p>All rights reserved.</p>
  </div>
  <div class="totalcount">
    <span> 这个人已经废话了 296.3k 字！ </span>
  </div>
</footer>

<script>
  var initMenu = () => {
    var navButtons = document.querySelectorAll('.nav-button');
    var navMenu = document.querySelector('#nav-menu');
    var navSocialLinks = document.querySelector('#nav-social-links');

    for (var button of navButtons) {
      button.addEventListener('click', () => {
        console.log('click')
        navMenu.classList.toggle("hidden");

        if (navSocialLinks) {
          navSocialLinks.classList.toggle("hidden");
        }

        for (var navButton of navButtons) {
          navButton.classList.toggle("hidden");
        };
      });
    }
  }
  document.addEventListener('turbolinks:load', initMenu());
</script>


<script>
  var initHeader = () => {
    let scrollPos = window.scrollY;
    var header = document.querySelector('#header');
    var headerContainer = document.querySelector("#header-container");
    var readingProgressBar = document.querySelector("#reading-progress-bar");
    let scrollTop = 0;
    let scrollBottom = 0;
    let scrollPercent = 0;

    var addClassOnScroll = () => {
      header.classList.add("shadow");
      header.classList.add("bg-white-90");
      header.classList.remove("py-4");
    }
    var removeClassOnScroll = () => {
      header.classList.remove("shadow");
      header.classList.remove("bg-white-90");
      header.classList.add("py-4");
    }

    window.onscroll = function () {
      scrollPos = window.scrollY;
      scrollTop = document.documentElement["scrollTop"] || document.body["scrollTop"];
      scrollBottom = (document.documentElement["scrollHeight"] || document.body["scrollHeight"]) - document.documentElement.clientHeight;
      scrollPercent = scrollTop / scrollBottom * 100;
      readingProgressBar.style.width = (scrollTop / scrollBottom * 100) + '%';

      if (scrollPos > 0) { addClassOnScroll() }
      else { removeClassOnScroll() }
    }
  }
  document.addEventListener('turbolinks:load', initHeader());
</script>


</body>

</html>



